<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FTC Track Viewer</title>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/geojs@1.14.1/geo.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
    <script type="text/javascript" src="./tracks.js?_=d94b3e5" defer></script>
    <style>
      html,
      body,
      body {
        width: 100%;
        height: 100%;
        padding: 0;
        margin: 0;
        overflow: hidden;      
      }
      #map {
        width: 70vw;
        height: 100%;
        padding: 0;
        margin: 0;
        overflow: hidden;
        position: absolute;
        left: 30vw;
        top: 0;
        bottom: 0;
        right: 100%;
      }
      #controls {
        width: 30vw;
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        user-select: none;
        padding: 10px;
        display: flex;
        flex-direction: column;
        overflow-y: auto;
        box-sizing: border-box;
      }
      #controls span {
        padding: 5px 5px 5px 0;
      }
      #controls.hidden, #controls .hidden {
        display: none;
      }
      .control-group {
        display: flex;
        align-items: center;
        width: 100%;
      }
      .control-group>span {
        width: 35px;
      }
      #controls input[type='number'] {
        width: 55px;
      }
      #controls input[type='range'] {
        flex: 1;
        min-width: 30px;
      }
      #tracks, #docs {
        width: 100%;
      }
      #tracks {
        overflow-x: auto;
      }
      #tracks option {
        min-width: max-content;
      }
      #controls textarea {
        width: 100%;
        min-height: 300px;
        flex-grow: 1;
        resize: vertical;
        flex-shrink: 0;
      }
      .svg-icon {
        width: 20px;
        height: 20px;
      }
      #info {
        position: absolute;
        bottom: 0;
        right: 0;
        background: rgba(255,255,255,0.75);
        padding: 2px;
      }
      #expand-docs {
        float: right;
      }
      #docs-instructions {
        display: none;
        user-select: text;
      }
      #docs-instructions.show {
        display: unset;
      }
      #docs-instructions .indent {
        text-indent: 20px;
      }
      #docs-instructions span {
        background: #EEE;
        font-family: monospace;
        padding: 0;
      }
.play-controls {
  display: flex;
  align-items: center;
  width: 100%;
}

.spacer {
  flex-grow: 1;
}
.svg-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  margin: 0px 4px 1px 0px;
}

    </style>
  </head>
  <body>
    <div
      id="map"
      class="geojs-map highlight-focus"
      tabindex="0"
      style="touch-action: none; user-select: none; -webkit-user-drag: none; -webkit-tap-highlight-color: rgba(0, 0, 0, 0)">
    </div>
    <div id="info"></div>
    <div id="controls">
      <div>
        <div class="control-group">
          <span>Start</span>
          <input id="start" type="range" min="0" value="0" step="0.001" max="31.780441832027815" />
          <input id="start-value" type="number" min="0" step="0.001" max="31.780441832027815" />
        </div>
        <div class="control-group">
          <span>End</span>
          <input id="end" type="range" min="0" value="40" step="0.001" max="31.780441832027815" />
          <input id="end-value" type="number" min="0" step="0.001" max="31.780441832027815" />
        </div>      
      </div>
      <div class="play-controls">
        <button id="pause-anim" class="svg-button" title="Pause">
          <svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
            <path d="M5 2L9 2L9 18L5 18ZM11 2L15 2L15 18L11 18Z" fill="black" stroke="transparent"/>
          </svg>
        </button>
        <button id="play-anim" class="svg-button" title="Play current track">
          <svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
            <path d="M17 10L3 2L3 18Z" fill="black" stroke="transparent"/>
          </svg>
        </button>
        <button id="play-all-anim" class="svg-button" title="Play all tracks">
          <svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
            <path d="M20 10L9 3L9 8L0 3L0 17L9 12L9 17Z" fill="black" stroke="transparent"/>
          </svg>
        </button>
		<div class="spacer"></div>
        <button id="jump" class="svg-button" title="Jump to first selected path">
          <svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
            <path d="M10 2L18 10L10 18L10 13L2 13L2 7L10 7Z" fill="black" stroke="transparent"/>
          </svg>
        </button>
        <button id="reset" class="svg-button" title="Reset paths">
          <svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
			<circle cx="10" cy="10" r="7" fill="transparent" stroke="black" stroke-width="2"/>
            <path d="M5 5L15 15" stroke="black" stroke-width="2"/>
          </svg>
        </button>
      </div>
      <div>
        <select id="tracks" multiple="multiple"></select>
      </div>
      <div>Path Records:</div>
      <textarea id="paths" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
Path,BlueBasketGoToNetZoneSubmersiblePick0GetSampleOut
start,39.5,63.125,180
drop0,59,60,-130,0.25,,0.35
pick1,47.0,48.0,-90.0,0.25
sweep1,48,24,-90,0.1
pick1,47.0,48.0,-90.0,0.25,false,0.1
drop,58.5,60.5,-130,0.25,,0.35
pick2,58.0,48.0,-90.0,0.25
sweep2,58,24,-90,0.1
pick2,58.0,48.0,-90.0,0.25,false,0.1
drop,58.5,60.5,-130,0.25,,0.35
pick3,57,41,-60,0.25
sweep3,62.5,24,-85,0.1
pick2,58.0,48.0,-90.0,0.25,false,0.1
drop,58.5,60.5,-130,0.25,,0.35
levelOneAscentApproach,30,9,180,0.8,false
submersiblePickLeft,19,8,180,,,0.2
Path,BlueBasketGoToNetZoneSubmersiblePick0JustLevelOne
start,39.5,63.125,180
drop0,59,60,-130,0.25,,0.35
pick1,47.0,48.0,-90.0,0.25
sweep1,48,24,-90,0.1
pick1,47.0,48.0,-90.0,0.25,false,0.1
drop,58.5,60.5,-130,0.25,,0.35
pick2,58.0,48.0,-90.0,0.25
sweep2,58,24,-90,0.1
pick2,58.0,48.0,-90.0,0.25,false,0.1
drop,58.5,60.5,-130,0.25,,0.35
pick3,57,41,-60,0.25
sweep3,62.5,24,-85,0.1
pick2,58.0,48.0,-90.0,0.25,false,0.1
drop,58.5,60.5,-130,0.25,,0.35
levelOneAscentApproach,30,9,180,0.8,false
submersiblePickLeft,19,8,180,,,0.2
      </textarea>
      <div id="docs">
<div>Times are not accurate.<button id="expand-docs">Instructions</button></div>
<div id="docs-instructions">
    <div class="indent">Each path starts with a line <span class="code">Path, &lt;path name&gt;</span>. Each position in a path is a line of the form <span class="code">&lt;name&gt;, &lt;x&gt;, &lt;y&gt;, &lt;heading&gt;, &lt;speed&gt;, &lt;stop&gt;, &lt;delay&gt;, &lt;image number&gt;</span>.  Everything after heading is optional; to skip a column leave it blank.  Image number can also be <span class="code">&lt;image number&gt;:&lt;part number&gt;:&lt;part offset x&gt;:&lt;part offset y&gt;:&lt;part rotation&gt;</span> with any number of parts, layered on top of the robot image.</div>
  <div class="indent">To change a setting, add lines <span class="code">Setting, &lt;setting&gt;, &lt;value&gt;</span>.  Valid settings are:</div>
  <div><span class="code">Setting,maxSpeed,60</span>  In inches/second.</div>
  <div><span class="code">Setting,defaultSpeed,0.75</span>  Range of 0 to 1, relative to maxSpeed.</div>
  <div><span class="code">Setting,stopTime,0.5</span>  In seconds.  How long it takes the robot to accurately stop between path segments.</div>
  <div><span class="code">Setting,fullSpeedDistance,12</span>  In inches.  How far away the robot is from a target position when it starts slowing down from maxSpeed.</div>
  <div><span class="code">Setting,noStopFullSpeedDistance,12</span>  In inches.  How far away the robot is from a target position when it starts slowing down from maxSpeed if it won't stop at the end of the path segment.</div>
  <div><span class="code">Setting,minSpeed,0.1</span>  Range of 0 to 1, relative to maxSpeed.  What is the slowest the robot will be ordered to move to avoid stalling the motors.</div>
  <div><span class="code">Setting,timeToSpeedUp,0.5</span>  In seconds.  How quickly is the robot ordered up to maxSpeed.</div>
  <div><span class="code">Setting,fixedTimes,false</span>  Set to true to not calculate path times and just use the delay.</div>
  <div><span class="code">Setting,asArrows,false</span>  Set to true to show arrows instead of a robot image.</div>
  <div><span class="code">Setting,matsAs24,true</span>  Use true to treat mats as if they are 24 inches square; false for the actual 23.625 inch value.</div>
  <div><span class="code">Setting,showText,true</span>  Show position labels along selected paths.</div>
  <div><span class="code">Setting,showArrows,true</span>  Show robot orientation arrows along selected paths</div>
  <div><span class="code">Setting,showRobot,true</span>  Show robot or arrows along selected paths</div>
  <div><span class="code">Setting,showPath,true</span>  Show robot path lines along selected paths.</div>
  <div><span class="code">Setting,playInitialPause,3.0</span>  Seconds to wait before each path when animating paths.</div>
  <div><span class="code">Setting,playFinalPause,3.0</span>  Seconds to wait after each path when animating paths.</div>
  <div class="indent">To change the field image, add a line <span class="code">Field, &lt;url&gt;, &lt;left&gt;, &lt;top&gt;, &lt;right&gt;, &lt;bottom&gt;</span>, where the sides are the number of inches from the side of the image to the center of the field.</div>
  <div class="indent">To change or add robot images, add lines <span class="code">Robot, &lt;image number&gt;, &lt;url&gt;, &lt;left&gt;, &lt;front&gt;, &lt;right&gt;, &lt;back&gt;</span>, where the sides are the number of inches from the side of the image to the center of the robot.</div>
  <div class="indent">To change or add robot sub-parts, add lines <span class="code">Part, &lt;part number&gt;, &lt;url&gt;, &lt;left&gt;, &lt;front&gt;, &lt;right&gt;, &lt;back&gt;</span>, where the sides are the number of inches from the side of the image to the center of the part.</div>
  <div class="indent">Lines starting with <span class="code">#</span> or that do not conform to the above specification are ignored.</div>
</div>
<div>See <a href="https://github.com/manthey/ftc-tracks">https://github.com/manthey/ftc-tracks</a>.</div>
      </div>
    </div>
  </body>
</html>
